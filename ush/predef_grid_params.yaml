#
#-----------------------------------------------------------------------
#
# Set grid and other parameters according to the value of the predefined
# domain (PREDEF_GRID_NAME).  Note that the code will enter this script
# only if PREDEF_GRID_NAME has a valid (and non-empty) value.
#
####################
# The following comments need to be updated:
####################
#
# 1) Reset the experiment title (expt_title).
# 2) Reset the grid parameters.
# 3) If the write component is to be used (i.e. QUILTING is set to
#    "TRUE") and the variable WRTCMP_PARAMS_TMPL_FN containing the name
#    of the write-component template file is unset or empty, set that
#    filename variable to the appropriate preexisting template file.
#
# For the predefined domains, we determine the starting and ending indi-
# ces of the regional grid within tile 6 by specifying margins (in units
# of number of cells on tile 6) between the boundary of tile 6 and that
# of the regional grid (tile 7) along the left, right, bottom, and top
# portions of these boundaries.  Note that we do not use "west", "east",
# "south", and "north" here because the tiles aren't necessarily orient-
# ed such that the left boundary segment corresponds to the west edge,
# etc.  The widths of these margins (in units of number of cells on tile
# 6) are specified via the parameters
#
#   num_margin_cells_T6_left
#   num_margin_cells_T6_right
#   num_margin_cells_T6_bottom
#   num_margin_cells_T6_top
#
# where the "_T6" in these names is used to indicate that the cell count
# is on tile 6, not tile 7.
#
# Note that we must make the margins wide enough (by making the above
# four parameters large enough) such that a region of halo cells around
# the boundary of the regional grid fits into the margins, i.e. such
# that the halo does not overrun the boundary of tile 6.  (The halo is
# added later in another script; its function is to feed in boundary
# conditions to the regional grid.)  Currently, a halo of 5 regional
# grid cells is used around the regional grid.  Setting num_margin_-
# cells_T6_... to at least 10 leaves enough room for this halo.
#
#-----------------------------------------------------------------------
#
#-----------------------------------------------------------------------
#
# The RRFS CONUS domain with ~25km cells.
#
#-----------------------------------------------------------------------
#
"RRFS_CONUS_25km":
  GRID_GEN_METHOD: "ESGgrid"
  grid_settings:
    lon_ctr: -97.5
    lat_ctr: 38.5
    delx: 25000.0
    dely: 25000.0
    nx: 219
    ny: 131
    pazi: 0.0
    halo_width: 6
  DT_ATMOS: 150
  LAYOUT_X: 5
  LAYOUT_Y: 2
  BLOCKSIZE: 40
  QUILTING:
    write_groups: 1
    write_tasks_per_group: 2
    cen_lon: -97.5
    cen_lat: 38.5
    lon1: -122.719528
    lat1: 21.138123
    stdlat1: 38.5
    stdlat2: 38.5
    output_grid: "lambert_conformal"
    nx: 217
    ny: 128
    dx: 25000.0
    dy: 25000.0
#
#-----------------------------------------------------------------------
#
# The RRFS CONUS domain with ~25km cells that can be initialized from the HRRR.
#
#-----------------------------------------------------------------------
#
"RRFS_CONUScompact_25km":
  GRID_GEN_METHOD: "ESGgrid"
  grid_settings:
    lon_ctr: -97.5
    lat_ctr: 38.5
    delx: 25000.0
    dely: 25000.0
    nx: 202
    ny: 116
    pazi: 0.0
    halo_width: 6
  DT_ATMOS: 180
  LAYOUT_X: 5
  LAYOUT_Y: 2
  BLOCKSIZE: 40
  QUILTING:
    write_groups: 1
    write_tasks_per_group: 2
    output_grid: "lambert_conformal"
    cen_lon: -97.5
    cen_lat: 38.5
    stdlat1: 38.5
    stdlat2: 38.5
    nx: 199
    ny: 111
    lon1: -121.23349066
    lat1: 23.41731593
    dx: 25000.0
    dy: 25000.0
#
#-----------------------------------------------------------------------
#
# The RRFS CONUS domain with ~13km cells.
#
#-----------------------------------------------------------------------
#
"RRFS_CONUS_13km":
  GRID_GEN_METHOD: "ESGgrid"
  grid_settings:
    lon_ctr: -97.5
    lat_ctr: 38.5
    delx: 13000.0
    dely: 13000.0
    nx: 420
    ny: 252
    pazi: 0.0
    halo_width: 6
  DT_ATMOS: 75
  LAYOUT_X: 16
  LAYOUT_Y: 10
  BLOCKSIZE: 32
  QUILTING:
    write_groups: 1
    write_tasks_per_group: 10
    output_grid: "lambert_conformal"
    cen_lon: -97.5
    cen_lat: 38.5
    stdlat1: 38.5
    stdlat2: 38.5
    nx: 416
    ny: 245
    lon1: -122.719528
    lat1: 21.138123
    dx: 13000.0
    dy: 13000.0
#
#-----------------------------------------------------------------------
#
# The RRFS CONUS domain with ~13km cells that can be initialized from the HRRR.
#
#-----------------------------------------------------------------------
#
"RRFS_CONUScompact_13km":
  GRID_GEN_METHOD: "ESGgrid"
  grid_settings:
    lon_ctr: -97.5
    lat_ctr: 38.5
    delx: 13000.0
    dely: 13000.0
    nx: 396
    ny: 232
    pazi: 0.0
    halo_width: 6
  DT_ATMOS: 75
  LAYOUT_X: 16
  LAYOUT_Y: 10
  BLOCKSIZE: 32
  QUILTING:
    write_groups: 1
    write_tasks_per_group: 16
    output_grid: "lambert_conformal"
    cen_lon: -97.5
    cen_lat: 38.5
    stdlat1: 38.5
    stdlat2: 38.5
    nx: 393
    ny: 225
    lon1: -121.70231097
    lat1: 22.57417972
    dx: 13000.0
    dy: 13000.0
#
#-----------------------------------------------------------------------
#
# The RRFS CONUS domain with ~3km cells.
#
#-----------------------------------------------------------------------
#
"RRFS_CONUS_3km":
  GRID_GEN_METHOD: "ESGgrid"
  grid_settings:
    lon_ctr: -97.5
    lat_ctr: 38.5
    delx: 3000.0
    dely: 3000.0
    nx: 1820
    ny: 1092
    pazi: 0.0
    halo_width: 6
  DT_ATMOS: 36
  LAYOUT_X: 28
  LAYOUT_Y: 28
  BLOCKSIZE: 28
  QUILTING:
    write_groups: 1
    write_tasks_per_group: 28
    output_grid: "lambert_conformal"
    cen_lon: -97.5
    cen_lat: 38.5
    stdlat1: 38.5
    stdlat2: 38.5
    nx: 1799
    ny: 1059
    lon1: -122.719528
    lat1: 21.138123
    dx: 3000.0
    dy: 3000.0
#
#-----------------------------------------------------------------------
#
# The RRFS CONUS domain with ~3km cells that can be initialized from the HRRR.
#
#-----------------------------------------------------------------------
#
"RRFS_CONUScompact_3km":
  GRID_GEN_METHOD: "ESGgrid"
  grid_settings:
    lon_ctr: -97.5
    lat_ctr: 38.5
    delx: 3000.0
    dely: 3000.0
    nx: 1748
    ny: 1038
    pazi: 0.0
    halo_width: 6
  DT_ATMOS: 36
  LAYOUT_X: 30
  LAYOUT_Y: 16
  BLOCKSIZE: 32
  QUILTING:
    write_groups: 1
    write_tasks_per_group: 16
    output_grid: "lambert_conformal"
    cen_lon: -97.5
    cen_lat: 38.5
    stdlat1: 38.5
    stdlat2: 38.5
    nx: 1746
    ny: 1014
    lon1: -122.17364391
    lat1: 21.88588562
    dx: 3000.0
    dy: 3000.0
#
#-----------------------------------------------------------------------
#
# A subconus domain over Indianapolis, Indiana with ~3km cells.  This is
# mostly for testing on a 3km grid with a much small number of cells than
# on the full CONUS.
#
#-----------------------------------------------------------------------
#
"SUBCONUS_Ind_3km":
  GRID_GEN_METHOD: "ESGgrid"
  grid_settings:
    lon_ctr: -86.16
    lat_ctr: 39.77
    delx: 3000.0
    dely: 3000.0
    nx: 200
    ny: 200
    pazi: 0.0
    halo_width: 6
  DT_ATMOS: 36
  LAYOUT_X: 5
  LAYOUT_Y: 5
  BLOCKSIZE: 40
  QUILTING:
    write_groups: 1
    write_tasks_per_group: 5
    output_grid: "lambert_conformal"
    cen_lon: -86.16
    cen_lat: 39.77
    stdlat1: 39.77
    stdlat2: 39.77
    nx: 197
    ny: 197
    lon1: -89.47120417
    lat1: 37.07809642
    dx: 3000.0
    dy: 3000.0
#
#-----------------------------------------------------------------------
#
# The RRFS Alaska domain with ~13km cells.
#
# Note:
# This grid has not been thoroughly tested (as of 20201027).
#
#-----------------------------------------------------------------------
#
"RRFS_AK_13km":
  GRID_GEN_METHOD: "ESGgrid"
  grid_settings:
    lon_ctr: -161.5
    lat_ctr: 63.0
    delx: 13000.0
    dely: 13000.0
    nx: 320
    ny: 240
    pazi: 0.0
    halo_width: 6
  DT_ATMOS: 10
  LAYOUT_X: 16
  LAYOUT_Y: 12
  BLOCKSIZE: 40
  QUILTING:
    write_groups: 1
    write_tasks_per_group: 12
    output_grid: "lambert_conformal"
    cen_lon: -161.5
    cen_lat: 63.0
    stdlat1: 63.0
    stdlat2: 63.0
    nx: 318
    ny: 234
    lon1: 172.23339164
    lat1: 45.77691870
    dx: 13000.0
    dy: 13000.0
#
#-----------------------------------------------------------------------
#
# The RRFS Alaska domain with ~3km cells.
#
# Note:
# This grid has not been thoroughly tested (as of 20201027).
#
#-----------------------------------------------------------------------
#
"RRFS_AK_3km":
  GRID_GEN_METHOD: "ESGgrid"
  grid_settings:
    lon_ctr: -161.5
    lat_ctr: 63.0
    delx: 3000.0
    dely: 3000.0
    nx: 1380
    ny: 1020
    pazi: 0.0
    halo_width: 6
  DT_ATMOS: 30
  LAYOUT_X: 30
  LAYOUT_Y: 17
  BLOCKSIZE: 40
  QUILTING:
    write_groups: 1
    write_tasks_per_group: 17
    output_grid: "lambert_conformal"
    cen_lon: -161.5
    cen_lat: 63.0
    stdlat1: 63.0
    stdlat2: 63.0
    nx: 1379
    ny: 1003
    lon1: -187.89737923
    lat1: 45.84576053
    dx: 3000.0
    dy: 3000.0
#
#-----------------------------------------------------------------------
#
# The WoFS domain with ~3km cells.
#
# Note:
# The WoFS domain will generate a 301 x 301 output grid (WRITE COMPONENT) and
# will eventually be movable (ESGgrid_LON_CTR/ESGgrid_LAT_CTR). A python script
# python_utils/fv3write_parms_lambert will be useful to determine
# lon1 and lat1 locations (only for Lambert map 
# projection currently) of the quilting output when the domain location is 
# moved. Later, it should be integrated into the workflow.
#
#-----------------------------------------------------------------------
#
"WoFS_3km":
  GRID_GEN_METHOD: "ESGgrid"
  grid_settings:
    lon_ctr: -97.5
    lat_ctr: 38.5
    delx: 3000.0
    dely: 3000.0
    nx: 361
    ny: 361
    pazi: 0.0
    halo_width: 6
  DT_ATMOS: 20
  LAYOUT_X: 18
  LAYOUT_Y: 12
  BLOCKSIZE: 30
  QUILTING:
    write_groups: "1"
    write_tasks_per_group: 12
    output_grid: "lambert_conformal"
    cen_lon: -97.5
    cen_lat: 38.5
    stdlat1: 38.5
    stdlat2: 38.5
    nx: 301
    ny: 301
    lon1: -102.3802487
    lat1: 34.3407918
    dx: 3000.0
    dy: 3000.0
#
#-----------------------------------------------------------------------
#
# A CONUS domain of GFDLgrid type with ~25km cells.
#
# Note:
# This grid is larger than the HRRRX domain and thus cannot be initialized
# using the HRRRX.
#
#-----------------------------------------------------------------------
#
"CONUS_25km_GFDLgrid":
  GRID_GEN_METHOD: "GFDLgrid"
  grid_settings:
    lon_t6_ctr: -97.5
    lat_t6_ctr: 38.5
    stretch_factor: 1.4
    num_cells: 96
    refine_ratio: 3
    istart_of_t7_on_t6g: 13
    iend_of_t7_on_t6g: 84
    jstart_of_t7_on_t6g: 17
    jend_of_t7_on_t6g: 80
  USE_NUM_CELLS_IN_FILENAMES: True
  DT_ATMOS: 225
  LAYOUT_X: 6
  LAYOUT_Y: 4
  BLOCKSIZE: 36
  QUILTING:
    write_groups: 1
    write_tasks_per_group: 4
    output_grid: "rotated_latlon"
    cen_lon: -97.5
    cen_lat: 38.5
    lon1: -24.40085141
    lat1: -19.65624142
    lon2: 24.40085141
    lat2: 19.65624142
    dlon: 0.22593381
    dlat: 0.22593381
#
#-----------------------------------------------------------------------
#
# A CONUS domain of GFDLgrid type with ~3km cells.
#
# Note:
# This grid is larger than the HRRRX domain and thus cannot be initialized
# using the HRRRX.
#
#-----------------------------------------------------------------------
#
"CONUS_3km_GFDLgrid":
  GRID_GEN_METHOD: "GFDLgrid"
  grid_settings:
    lon_t6_ctr: -97.5
    lat_t6_ctr: 38.5
    stretch_factor: 1.5
    num_cells: 768
    refine_ratio: 3
    istart_of_t7_on_t6g: 70
    iend_of_t7_on_t6g: 699
    jstart_of_t7_on_t6g: 165
    jend_of_t7_on_t6g: 604
  USE_NUM_CELLS_IN_FILENAMES: True
  DT_ATMOS: 36
  LAYOUT_X: 30
  LAYOUT_Y: 22
  BLOCKSIZE: 35
  QUILTING:
    write_groups: 1
    write_tasks_per_group: 22
    output_grid: "rotated_latlon"
    cen_lon: -97.5
    cen_lat: 38.5
    lon1: -25.23144805
    lat1: -15.82130419
    lon2: 25.23144805
    lat2: 15.82130419
    dlon: 0.02665763
    dlat: 0.02665763
#
#-----------------------------------------------------------------------
#
# 25-km HRRR grid for testing Online-CMAQ.
#
#-----------------------------------------------------------------------
#
"GSD_HRRR_25km":
  GRID_GEN_METHOD: "ESGgrid"
  ESGgrid_LON_CTR: -97.5
  ESGgrid_LAT_CTR: 38.5
  ESGgrid_DELX: 25000.0
  ESGgrid_DELY: 25000.0
  ESGgrid_NX: 200
  ESGgrid_NY: 110
  ESGgrid_PAZI: 180.0
  ESGgrid_WIDE_HALO_WIDTH: 6
  DT_ATMOS: 300
  LAYOUT_X: 10
  LAYOUT_Y: 11
  BLOCKSIZE: 2
  QUILTING:
    write_groups: 1
    write_tasks_per_group: 10
    output_grid: "lambert_conformal"
    cen_lon: -97.5
    cen_lat: 38.5
    stdlat1: 38.5
    stdlat2: 38.5
    nx: 191
    ny: 97
    lon1: -120.72962370
    lat1: 25.11648583
    dx: 25000.0
    dy: 25000.0
#
#-----------------------------------------------------------------------
#
# 13-km AQM NA grid for Online-CMAQ.
#
#-----------------------------------------------------------------------
#
"AQM_NA_13km":
  GRID_GEN_METHOD: "ESGgrid"
  grid_settings:
    lon_ctr: -118.0
    lat_ctr: 50.0
    delx: 13000.0
    dely: 13000.0
    nx: 800
    ny: 544
    pazi: 0.0
    halo_width: 6
  DT_ATMOS: 180
  LAYOUT_X: 50
  LAYOUT_Y: 34
  BLOCKSIZE: 16
  QUILTING:
    write_groups: 2
    write_tasks_per_group: 46
    output_grid: "rotated_latlon"
    cen_lon: -118.0
    cen_lat: 50.0
    lon1: -45.25
    lat1: -28.5
    lon2: 45.25
    lat2: 28.5
    dlon: 0.116908139
    dlat: 0.116908139
#
#-----------------------------------------------------------------------
#
# Emulation of GSD's RAP domain with ~13km cell size.
#
#-----------------------------------------------------------------------
#
"RRFS_NA_13km":
  GRID_GEN_METHOD: "ESGgrid"
  grid_settings:
    lon_ctr: -112.5
    lat_ctr: 55.0
    delx: 13000.0
    dely: 13000.0
    nx: 912
    ny: 623
    pazi: 0.0
    halo_width: 6
  DT_ATMOS: 75
  LAYOUT_X: 16
  LAYOUT_Y: 16
  BLOCKSIZE: 30
  QUILTING:
    write_groups: 1
    write_tasks_per_group: 16
    output_grid: "rotated_latlon"
    cen_lon: -113.0
    cen_lat: 55.0
    lon1: -61.0
    lat1: -37.0
    lon2: 61.0
    lat2: 37.0
    dlon: 0.1169081
    dlat: 0.1169081
#
#-----------------------------------------------------------------------
#
# Future operational RRFS domain with ~3km cell size.
#
#-----------------------------------------------------------------------
#
"RRFS_NA_3km":
  GRID_GEN_METHOD: "ESGgrid"
  grid_settings:
    lon_ctr: -112.5
    lat_ctr: 55.0
    delx: 3000.0
    dely: 3000.0
    nx: 3950
    ny: 2700
    pazi: 0.0
    halo_width: 6
  DT_ATMOS: 36
  LAYOUT_X: 20   # 40 - EMC operational configuration
  LAYOUT_Y: 35   # 45 - EMC operational configuration
  BLOCKSIZE: 28
  QUILTING:
    write_groups: 1
    write_tasks_per_group: 144
    output_grid: "rotated_latlon"
    cen_lon: -113.0
    cen_lat: 55.0
    lon1: -61.0
    lat1: -37.0
    lon2: 61.0
    lat2: 37.0
    dlon: 0.025
    dlat: 0.025

